---
title: "Soils of Lassen Volcanic National Park"
---

## Introduction 

Understanding the basic concepts of soil formation and genesis applied across landscapes is
difficult, it requires traversing the landscape and lots of digging or researching soil survey maps.
Finding, organizing, exploring and interpreting NRCS soil survey maps and data is a process
which consumes a lot of time and has evolved through the years from a strict physical format
into flexible digital formats. However, just because something is in a new digital format does
not always make the job easier as often times digital formats are stored in multiple online
databases and hosted with different web services.

The tools available from the NRCS include very large and robust yet clunky web soil survey app
(https://websoilsurvey.sc.egov.usda.gov/App/WebSoilSurvey.aspx), the soil data access portal
(https://sdmdataaccess.nrcs.usda.gov/) offers links to backend SQL services and web queryable
data from the data mart (https://ncsslabdatamart.sc.egov.usda.gov/) (Soil Survey, 2019). The
California resource soil lab at UC Davis has built a few higher level services to make this process
easier such as the SoilWeb apps (https://casoilresource.lawr.ucdavis.edu/soilweb-apps/)
(Beaudette et al., 2009). Additionally, climate and meteorological information in stored in
other databases which are accessed separately and must be joined with previous soil data
resources.

While the sheer access to raw data and information is enormous it takes a considerable amount
of time to organize, clean, and produce usable graphics from. There has been considerable
work in trying to simplify and improve workflow programmatically by the National Cooperative
Soil Survey. The algorithms for quantitative pedology package (soilAQP) for the R programming
language provides build in functions for querying, organizing, cleaning and producing tables
graphs from the multitudes of NRCS soil survey data available, as well as methods for querying
meteorological data (Beaudette et al., 2013) However, this requires an intermediate to
advanced knowledge of the R programming language as well as knowledge of querying
databases with SQL (R Core Team, 2013).

A simple and more direct method can be employed by referencing the paper copies of the soil
surveys produced by the NRCS, which are now also available in electronic PDF format and
contain most of the information required by a soil scientist to explore and learn about a new
and different landscapes in the United States.

If a curious soil scientist in potentia desired to learn more about the soils in the Cascade Range
of California north of the Sierra Nevada, Lassen Volcanic National Park seems like a good place
to start. Lassen Volcanic National Park is home to all 4 volcano types (cinder cone, plug dome,
shield, and stratovolcano). When coupled with other soil forming factors (climate, topography,
organics, time), the potential for an innovative and engaging opportunity for understanding
mechanisms of pedogenesis of soils in Lassen Volcanic National Park becomes clear especially
of less common soils such an Andisols. The objectives of this research is to
i) Learn about soil property relationships in Lassen Volcanic National Park Andisols
ii) Evaluate the soil survey data and information available and methods of use

## Methods

Soils in Lassen National Park were explored digitally through the use of SoilWeb to identify
potential trends and series to access data and gather more information about (Beaudette et al.,
2009). The soil Terracelake, Emeraldlake, Shadowlake, Juniperlake, and Buttelake series were
chosen as a subset of series to explore mostly to do the similarities of the “-lake” in their
naming structure. Four of the five soils are classified as Andisols, with Emeraldlake classified as
an Entisol with andic properties. The inclusion of a non Andisol soil may also serve as a subtle
contrast between the breakouts of an Andisol and an Entisol with Vitrandic properties (Table 5).
The soil datamart was accessed for soil series chemical data but did not have lab data for the
most of the soil series to be investigated. Soilweb provided access to soil taxonomy, physical
and some chemical data (horzons, particle size fractions, % organic matter, pH, CEC, and bulk
density) available (Table 5,6). The NRCS Soil Survey published in 2010 and was consulted to find
Andisol specific chemical information (NaF pH, %glass, P retention, and Al +1/2 Fe) and
appended to data found from the soil web database (Table 6)(Soil Survey, 2010). Soil chemical
and physical relationships such as were graphed in excel using the the data previously
organized (Figures 1-7).

Soil survey information from the CA078 survey area was queried from the NRCS Soil Data access
pathway with built in methods from the soilAQP package and used to create soil taxonomy and
map unit inclusion information in tables 1 – 4. Soil series profile sketches and dendrograms,
which show taxonomic relationships between series, were developed using the soilAQP
package as well (Figures 8 - 11) (Beaudette et al., 2013, Soil Survey, 2019).

The tables and graphs were analyzed for basic observable relationships and trends, statistical
methods were not employed to validate observations due to time constraints.

## Code 

```{r}
## load tidyverse
library(tidyverse)

## load soilverse
library(aqp)
library(soilDB)
library(plyr)
library(sharpshootR)
library(knitr)
library(dplyr)
```

```{r}
## import lassen soils data csv
lassenSoils <- read_csv("LassenSoilData.csv")
```

```{r}

```

```{r}

```
### Soil AQP and Dendrograms
```{r}
## add functions to work with soil AQP data
# compute total component percentages for the current block of components
f.sum <- function(i) {
   n <- nrow(i) # number of rows
   s <- sum(i$comppct_r) # total component percent
   return(data.frame(pct=s, n=n)) # return the results
}

# pick the largest suborder from within each map unit
f.largest <- function(i) {
   i.sorted <- i[order(i$pct, decreasing=TRUE), ] # sort largest -> smallest
   top.suborder <- i.sorted$taxsuborder[1] # get the largest suborder
   top.suborder.pct <- i.sorted$pct[1] # get the the corresponding component percent
   return(data.frame(suborder=top.suborder, pct=top.suborder.pct)) # return results
}

```

```{r message=FALSE, warning=FALSE}
## Query data from soilweb API


# get map unit-level data
q.1 <- "SELECT mukey, muacres
FROM legend
INNER JOIN mapunit ON mapunit.lkey = legend.lkey
WHERE legend.areasymbol = 'CA789'"

# get component-level data
q.2 <- "SELECT 
component.mukey, cokey, comppct_r, compname, taxclname, taxorder, taxsuborder, taxgrtgroup, taxsubgrp
FROM legend
INNER JOIN mapunit ON mapunit.lkey = legend.lkey
LEFT OUTER JOIN component ON component.mukey = mapunit.mukey
WHERE legend.areasymbol = 'CA789'"

# submit queries
mu <- SDA_query(q.1)
co <- SDA_query(q.2)

# tabulate percentage of suborder-level taxa within each map unit (mukey)
l <- comp.suborder.sums <- ddply(co, .(mukey, taxsuborder), f.sum)

# keep the largest suborder, and its associated total percentage
comp.suborder <- ddply(l, .(mukey), f.largest)

# join the largest suborder (by map unit) to mu
x <- join(mu, comp.suborder, by='mukey')

# get an effective map unit area via: muacres * pct/100
x$effective.area <- with(x, muacres * pct / 100)


```

```{r cars}
sort(round(tapply(x$effective.area, x$suborder, sum)))

co %>% group_by(compname) %>% 
         dplyr::summarise(n=n()) %>% 
         kable()
```

```{r pressure}
sl.list <- c('terracelake', 'emeraldlake', 'shadowlake', 'buttelake', 'juniperlake')

# fetch and convert data into an SPC
ls4 <- fetchOSD(sl.list)

kssl.1 <- fetchKSSL('terracelake')
kssl.2 <- fetchKSSL('emeraldlake')
kssl.3 <- fetchKSSL('shadowlake')
kssl.4 <- fetchKSSL('buttelake')
kssl.5 <- fetchKSSL('juniperlake')
```
